/**
 * @file test/basic-input-test.js
 * @author graeme@converse.ai
 * @description Parse a date from any format.
 *
 * Generated by the converse-cli tool for use with the ConverseAI
 * Plugins SDK. https://developers.converse.ai/
 */

const test = require('./request-parse');
const chai        = require('chai');
const expect      = chai.expect; chai.use(require('chai-match'));

describe('Parse Basic', function () {



  /* * * * * * * * * * * * * * * * * *
  * Without Input
  * * * * * * * * * * * * * * * * * */

  it('without input', function(done) {
    test({}, {isValid: true}, done);
  })


  /* * * * * * * * * * * * * * * * * *
  * With broken input
  * * * * * * * * * * * * * * * * * */

  it('with broken input', function(done) {
    test({
      input: 'Hello, World!'
    }, function(err, res) {
      expect(res.body).to.have.property('status').to.equal(0);
      expect(res.body).to.have.property('value').to.have.property('isValid').to.equal(false);
      done();
    }, done);
  })

  /* * * * * * * * * * * * * * * * * *
  * Basic Inputs
  * * * * * * * * * * * * * * * * * */

  it('with human input (Sunday 2nd July, 9:30pm)', function(done) {
    test({
      input: 'Sunday 2nd July, 9:30pm',
      offset: undefined,
      custom_offset: undefined,
      timezone_offset: undefined
    }, {
      years: 2017,
      months: 7,
      date: 2,
      hours: 21,
      minutes: 30,
      seconds: 0,
      milliseconds: 0,
      offset: '+00:00',
      iso: '2017-07-02T21:30:00+00:00',
      utc: '2017-07-02T21:30:00+00:00',
      unix: 1499031000,
      isValid: true
    }, done);
  })

  it('with human input (02/07/2017) with locale (en-gb)', function(done) {
    test({
      input: '02/07/2017',
      locale: 'en-gb',
      offset: undefined,
      custom_offset: undefined,
      timezone_offset: undefined
    }, {
      years: 2017,
      months: 7,
      date: 2,
      hours: 0,
      minutes: 0,
      seconds: 0,
      milliseconds: 0,
      offset: '+00:00',
      iso: '2017-07-02T00:00:00+00:00',
      utc: '2017-07-02T00:00:00+00:00',
      unix: 1498953600,
      isValid: true
    }, done);
  })

  it('with human input (13/07/2017)', function(done) {
    test({
      input: '13/07/2017',
      locale: '',
      offset: undefined,
      custom_offset: undefined,
      timezone_offset: undefined
    }, {
      years: 2017,
      months: 7,
      date: 13,
      hours: 0,
      minutes: 0,
      seconds: 0,
      milliseconds: 0,
      offset: '+00:00',
      iso: '2017-07-13T00:00:00+00:00',
      utc: '2017-07-13T00:00:00+00:00',
      unix: 1499904000,
      isValid: true
    }, done);
  })

  it('with human input (9.30pm) with locale (en-gb)', function(done) {
    test({
      input: '9.30pm',
      locale: 'en-gb',
      offset: undefined,
      custom_offset: undefined,
      timezone_offset: undefined
    }, {
      hours: 21,
      minutes: 30,
      seconds: 0,
      milliseconds: 0,
      offset: '+00:00',
      isValid: true
    }, done);
  })

  it('with human input (2/7/2017 9:30pm) with locale (en-gb)', function(done) {
    test({
      input: '2/7/2017 9:30pm',
      locale: 'en-gb',
      offset: undefined,
      custom_offset: undefined,
      timezone_offset: undefined
    }, {
      years: 2017,
      months: 7,
      date: 2,
      hours: 21,
      minutes: 30,
      seconds: 0,
      milliseconds: 0,
      offset: '+00:00',
      iso: '2017-07-02T21:30:00+00:00',
      utc: '2017-07-02T21:30:00+00:00',
      unix: 1499031000,
      isValid: true
    }, done);
  })

  it('with human input (2 de julio de 2017) with locale (es)', function(done) {
    test({
      input: '2 de julio de 2017',
      locale: 'es',
      offset: undefined,
      custom_offset: undefined,
      timezone_offset: undefined
    }, {
      years: 2017,
      months: 7,
      date: 2,
      hours: 0,
      minutes: 0,
      seconds: 0,
      milliseconds: 0,
      offset: '+00:00',
      iso: '2017-07-02T00:00:00+00:00',
      utc: '2017-07-02T00:00:00+00:00',
      unix: 1498953600,
      isValid: true
    }, done);
  })

  it('with ISO_8601 input (2017-07-02T21:30:00+00:00)', function(done) {
    test({
      input: '2017-07-02T21:30:00+00:00',
      offset: undefined,
      custom_offset: undefined,
      timezone_offset: undefined
    }, {
      years: 2017,
      months: 7,
      date: 2,
      hours: 21,
      minutes: 30,
      seconds: 0,
      milliseconds: 0,
      offset: '+00:00',
      iso: '2017-07-02T21:30:00+00:00',
      utc: '2017-07-02T21:30:00+00:00',
      unix: 1499031000,
      isValid: true
    }, done);
  })

  it('with zoned ISO_8601 input (2017-07-02T21:30:00-07:00)', function(done) {
    test({
      input: '2017-07-02T21:30:00-07:00',
      offset: undefined,
      custom_offset: undefined,
      timezone_offset: undefined
    }, {
      years: 2017,
      months: 7,
      date: 2,
      hours: 21,
      minutes: 30,
      seconds: 0,
      milliseconds: 0,
      offset: '-07:00',
      iso: '2017-07-02T21:30:00-07:00',
      utc: '2017-07-03T04:30:00+00:00',
      unix: 1499056200,
      isValid: true
    }, done);
  })

  it('with unix timestamp input (String: 1499031000)', function(done) {
    test({
      input: '1499031000',
      offset: undefined,
      custom_offset: undefined,
      timezone_offset: undefined
    }, {
      years: 2017,
      months: 7,
      date: 2,
      hours: 21,
      minutes: 30,
      seconds: 0,
      milliseconds: 0,
      offset: '+00:00',
      iso: '2017-07-02T21:30:00+00:00',
      utc: '2017-07-02T21:30:00+00:00',
      unix: 1499031000,
      isValid: true
    }, done);
  })

  it('with unix timestamp input (Int: 1499031000)', function(done) {
    test({
      input: 1499031000,
      offset: undefined,
      custom_offset: undefined,
      timezone_offset: undefined
    }, {
      years: 2017,
      months: 7,
      date: 2,
      hours: 21,
      minutes: 30,
      seconds: 0,
      milliseconds: 0,
      offset: '+00:00',
      iso: '2017-07-02T21:30:00+00:00',
      utc: '2017-07-02T21:30:00+00:00',
      unix: 1499031000,
      isValid: true
    }, done);
  })

  /* * * * * * * * * * * * * * * * * *
  * Basic Input & Offset
  * * * * * * * * * * * * * * * * * */

  it('with human input (Sunday 2nd July, 9:30pm) && static offset (-07:00)', function(done) {
    test({
      input: 'Sunday 2nd July, 9:30pm',
      offset: '-07:00',
      custom_offset: undefined,
      timezone_offset: undefined
    }, {
      years: 2017,
      months: 7,
      date: 2,
      hours: 21,
      minutes: 30,
      seconds: 0,
      milliseconds: 0,
      offset: '-07:00',
      iso: '2017-07-02T21:30:00-07:00',
      utc: '2017-07-03T04:30:00+00:00',
      unix: 1499056200,
      isValid: true
    }, done);
  })

  it('with human input (Sunday 2nd July, 9:30pm) && custom offset (-07:00)', function(done) {
    test({
      input: 'Sunday 2nd July, 9:30pm',
      offset: 'CUSTOM',
      custom_offset: '-07:00',
      timezone_offset: undefined
    }, {
      years: 2017,
      months: 7,
      date: 2,
      hours: 21,
      minutes: 30,
      seconds: 0,
      milliseconds: 0,
      offset: '-07:00',
      iso: '2017-07-02T21:30:00-07:00',
      utc: '2017-07-03T04:30:00+00:00',
      unix: 1499056200,
      isValid: true
    }, done);
  })

  it('with human input (Sunday 2nd July, 9:30pm) && timezone offset (-07:00)', function(done) {
    test({
      input: 'Sunday 2nd July, 9:30pm',
      offset: 'ZONE',
      custom_offset: undefined,
      timezone_offset: 'America/Los_Angeles'
    }, {
      years: 2017,
      months: 7,
      date: 2,
      hours: 21,
      minutes: 30,
      seconds: 0,
      milliseconds: 0,
      offset: '-07:00',
      iso: '2017-07-02T21:30:00-07:00',
      utc: '2017-07-03T04:30:00+00:00',
      unix: 1499056200,
      isValid: true
    }, done);
  })

  it('with ISO_8601 input (2017-07-02T21:30:00+00:00) && timezone offset (-07:00)', function(done) {
    test({
      input: '2017-07-02T21:30:00+00:00',
      offset: 'ZONE',
      custom_offset: undefined,
      timezone_offset: 'America/Los_Angeles'
    }, {
      years: 2017,
      months: 7,
      date: 2,
      hours: 21,
      minutes: 30,
      seconds: 0,
      milliseconds: 0,
      offset: '-07:00',
      iso: '2017-07-02T21:30:00-07:00',
      utc: '2017-07-03T04:30:00+00:00',
      unix: 1499056200,
      isValid: true
    }, done);
  })
});
